- ACID

- 明确概念：

  - 正确性：串行，等价串行

  - 冲突：读和写

    ![image-20241120132911004](https://my-pic.miaops.sbs/2024/11/image-20241120132911004.png)

并发控制与数据库恢复的具体手段：二阶段锁，隔离级别，时间戳排序，MVCC；redoundo日志，shadow page，恢复过程。

[TOC]

## 概念梳理

### ACID

并发控制与数据库恢复一体两面，在数据库系统中设计到如下部分：

![image-20241120154336607](https://my-pic.miaops.sbs/2024/11/image-20241120154336607.png)



数据库为达成一个目的的语句块称为一个事务，特殊地，一个语句本身就可以视为一个事务。

并发控制与数据库恢复的目标是实现事务的**ACID**：

- *Atomicity*：全或无。
- *Consistency*：数据整体一致；分布式场景下，强一致或最终一致。
- *Isolation*：事务并行，但是互不干涉。
- *Durability*：事务提交，就保证修改已经持久化。

![image-20241120171412872](https://my-pic.miaops.sbs/2024/11/image-20241120171412872.png) 

### 串行化与冲突操作

> 如何确定事务并发的执行结果是满足隔离性（*Insolation*）的？
> 答：事务是可串行化的，即并行调度结果和串行调度一致。

串行调度（*Serial Schedule*）：数据库每次只执行一个事务，不并行。

可串行化调度（*Serializable Schedule*）：允许事务并行，但是并行执行的结果可以等效为串行调度。

> 为什么有的事务是可串行化的，而有的无法串行化？
> 答：取决于是否包含（读写）冲突操作，存在冲突操作时，往往就是不可串行化的。

冲突操作：

- 读写冲突（*R-W*）：不可重复读，幻读
- 写读冲突（*W-R*）：脏页读
- 写写冲突（*W-W*）：更新丢失

![image-20241120165331790](https://my-pic.miaops.sbs/2024/11/image-20241120165331790.png)



> 如何判断一组事务是否可串行化？
>
> 答：依赖关系图（*Dependency Graph*）

![image-20241120165135138](https://my-pic.miaops.sbs/2024/11/image-20241120165135138.png)

